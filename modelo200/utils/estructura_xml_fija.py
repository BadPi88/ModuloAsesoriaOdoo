from lxml import etree

estructura_xml_fija = {'tipo_Pagina03': ['T00101', 'T00102', 'T00103', 'T00104', 'T00105', 'T00106', 'T00107', 'T00108', 'T00700', 'T00109', 'T00110', 'T00111', 'T00112', 'T00113', 'T00114', 'T00115', 'T00116', 'T00117', 'T00118', 'T00119', 'T00120', 'T00121', 'T00122', 'T00123', 'T00124', 'T00125', 'T00126', 'T00127', 'T00128', 'T00129', 'T00130', 'T00131', 'T00132', 'T00133', 'T00134', 'T00135', 'T00136', 'T00137', 'T00138', 'T00139', 'T00140', 'T00141', 'T00142', 'T00143', 'T00144', 'T00145', 'T00146', 'T00147', 'T00148', 'T00701'],
                       'tipo_Pagina04': ['T00149', 'T00150', 'T00151', 'T00152', 'T00153', 'T00154', 'T00155', 'T00156', 'T00157', 'T00158', 'T00159', 'T00160', 'T00161', 'T00162', 'T00163', 'T00164', 'T00165', 'T00166', 'T00167', 'T00168', 'T00169', 'T00170', 'T00171', 'T00172', 'T00173', 'T00174', 'T00175', 'T00176', 'T00177', 'T00178', 'T00179', 'T00180'],
                       'tipo_Pagina05': ['T00185', 'T00186', 'T00187', 'T00188', 'T00189', 'T00764', 'T00765', 'T00190', 'T00191', 'T00192', 'T00193', 'T00702', 'T01001', 'T01002', 'T00712', 'T00766', 'T00767', 'T00194', 'T00195', 'T00196', 'T00197', 'T00198', 'T00199', 'T00200', 'T00768', 'T00769', 'T00201', 'T00202', 'T00203', 'T00204', 'T00205', 'T00206', 'T00207', 'T00208', 'T00209', 'T00210', 'T00780', 'T00781', 'T00782', 'T00783', 'T00784', 'T00211', 'T00212', 'T00213', 'T00214', 'T00215', 'T00216', 'T00217', 'T00218', 'T00219', 'T00220', 'T00221', 'T00222', 'T00223', 'T00224', 'T00225', 'T00226', 'T00227'],
                       'tipo_Pagina06': ['T00228', 'T00785', 'T00786', 'T00787', 'T00788', 'T00789', 'T00229', 'T00230', 'T00703', 'T00704', 'T00231', 'T00232', 'T00233', 'T00234', 'T00235', 'T00236', 'T00237', 'T00238', 'T00239', 'T00240', 'T00241', 'T00242', 'T00243', 'T00244', 'T00245', 'T00246', 'T00247', 'T00248', 'T00249', 'T00250', 'T00251', 'T00252'],
                       'tipo_Pagina07': ['T00255', 'T00705', 'T00258', 'T00760', 'T00763', 'T00263', 'T00267', 'T00271', 'T00275', 'T00279', 'T00281', 'T00284', 'T00288', 'T00292', 'T00792', 'T00296', 'T00256', 'T00706', 'T00259', 'T00761', 'T00770', 'T00264', 'T00268', 'T00790', 'T00276', 'T00280', 'T00282', 'T00285', 'T00289', 'T00293', 'T00793', 'T00257', 'T00707', 'T00260', 'T00262', 'T00771', 'T00265', 'T00269', 'T00273', 'T00277', 'T00253', 'T00283', 'T00286', 'T00290', 'T00710', 'T00294', 'T00711', 'T00708', 'T00261', 'T00762', 'T00772', 'T00266', 'T00270', 'T00274', 'T00278', 'T00254', 'T00709', 'T00287', 'T00291', 'T00791', 'T00295'],
                       'tipo_Pagina08': ['T00297', 'T00298', 'T00299', 'T00300', 'T00301', 'T00302', 'T00303', 'T00794', 'T00304', 'T00305', 'T00306', 'T00307', 'T00308', 'T00796', 'T00309', 'T00310', 'T00311', 'T00312', 'T00313', 'T00314', 'T00315', 'T00316', 'T00317', 'T00318', 'T00319', 'T00320', 'T00321', 'T00322', 'T00323', 'T00329', 'T00330', 'T00331', 'T00332', 'T00324', 'T00325', 'T00326', 'T00327', 'T00328', 'T00500'],
                       'tipo_Pagina09': ['T00336', 'T00337', 'T00338', 'T00339', 'T00340', 'T00341', 'T00342', 'T00343', 'T00344', 'T00345', 'T00346', 'T00347', 'T00348', 'T00349', 'T00350', 'T00351', 'T00352', 'T00353', 'T00354', 'T00355', 'T00500'],
                       'tipo_Pagina10': ['T00380', 'T00384', 'T00395', 'T00399', 'T00410', 'T00414', 'T00425', 'T00436', 'T00440', 'T00451', 'T00455', 'T00466', 'T00470', 'T00481', 'T00492', 'T00496', 'T00507', 'T00511', 'T00522', 'T00526', 'T00537', 'T00548', 'T00552', 'T00563', 'T00567', 'T00578', 'T00582', 'T00593', 'T00604', 'T00608', 'T00619', 'T00623', 'T00717', 'T00721', 'T00732', 'T00632', 'T00636', 'T00381', 'T00385', 'T00396', 'T00400', 'T00411', 'T00422', 'T00426', 'T00437', 'T00441', 'T00452', 'T00456', 'T00467', 'T00478', 'T00482', 'T00493', 'T00497', 'T00508', 'T00512', 'T00523', 'T00534', 'T00538', 'T00549', 'T00553', 'T00564', 'T00568', 'T00579', 'T00590', 'T00594', 'T00605', 'T00609', 'T00620', 'T00624', 'T00718', 'T00729', 'T00733', 'T00633', 'T00637', 'T00382', 'T00386', 'T00397', 'T00408', 'T00412', 'T00423', 'T00427', 'T00438', 'T00442', 'T00453', 'T00464', 'T00468', 'T00479', 'T00483', 'T00494', 'T00498', 'T00509', 'T00520', 'T00524', 'T00535', 'T00539', 'T00550', 'T00554', 'T00565', 'T00576', 'T00580', 'T00591', 'T00595', 'T00606', 'T00610', 'T00621', 'T00715', 'T00719', 'T00730', 'T00734', 'T00634', 'T00638', 'T00383', 'T00394', 'T00398', 'T00409', 'T00413', 'T00424', 'T00428', 'T00439', 'T00450', 'T00454', 'T00465', 'T00469', 'T00480', 'T00484', 'T00495', 'T00506', 'T00510', 'T00521', 'T00525', 'T00536', 'T00540', 'T00551', 'T00562', 'T00566', 'T00577', 'T00581', 'T00592', 'T00596', 'T00607', 'T00618', 'T00622', 'T00716', 'T00720', 'T00731', 'T00735', 'T00635']}

def generar_xml(valores):
    root = etree.Element("MOD2002023")
    normal = etree.SubElement(root, "Normal")
    balance = etree.SubElement(normal, "Balance")
    cuenta = etree.SubElement(normal, "CuentaPyG")
    cambios = etree.SubElement(normal, "CambiosPN")

    for key, campos in estructura_xml_fija.items():
        if "Pagina03" in key:
            pagina = etree.SubElement(balance, "Pagina03")
        elif "Pagina04" in key:
            pagina = etree.SubElement(balance, "Pagina04")
        elif "Pagina05" in key:
            pagina = etree.SubElement(balance, "Pagina05")
        elif "Pagina06" in key:
            pagina = etree.SubElement(balance, "Pagina06")
        elif "Pagina07" in key:
            pagina = etree.SubElement(cuenta, "Pagina07")
        elif "Pagina08" in key:
            pagina = etree.SubElement(cuenta, "Pagina08")
        elif "Pagina09" in key:
            pagina = etree.SubElement(cambios, "Pagina09")
        elif "Pagina10" in key:
            pagina = etree.SubElement(cambios, "Pagina10")
        else:
            continue
        for campo in campos:
            etree.SubElement(pagina, campo).text = valores.get(campo, "")

    return etree.tostring(root, pretty_print=True, encoding="UTF-8", xml_declaration=True).decode()
